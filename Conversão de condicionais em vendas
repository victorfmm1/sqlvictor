SELECT
    SUM(iif(v.tipo_nd = 'D', v.total_venda, 0)) as dev_venda,
    SUM(iif(v.tipo_nd = 'N', v.total_venda, 0)) as total_venda,
    SUM(iif(v.tipo_nd = 'N', v.total_venda, 0)) - SUM(iif(v.tipo_nd = 'D', v.total_venda, 0)) as total_venda_liquido,
    v.vendedor,
    pp.nome

FROM vendas v
    left join parceiros pp on v.vendedor = pp.parceiro

WHERE
    v.dtacomp between :pDataIni and :pDataFim
    AND v.idn_cancelada = 'N'
    AND (v.vendedor = :Vendedor OR (:Vendedor = 0))

GROUP BY
    v.vendedor, pp.nome
